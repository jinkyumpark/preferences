(function(){function t(t){return t=/\d{2}/.test(t)?t:"0"+t}function e(t){return/\d{1,2}:\d{2}\s?\w{2}/.test(t)?/(\d{1,2}):(\d{2})\s?(\w{2})/.exec(t):null}function n(e){var n=parseInt(e[1]),i=e[2],r=e[3];return(n=/pm/i.test(r)?12===n?n:n+12:/am/i.test(r)&&12===n?t(0):t(n))+":"+i+":00"}function i(t,e){var n=new Date(1e3*t).toISOString(),i=null!==n&&/\d{4}-\d{2}-\d{2}/.test(n)?/(\d{4})-(\d{2})-(\d{2})/.exec(n):null;return i[1]+"-"+i[2]+"-"+i[3]+"T"+e}function r(t,r){var s=t.toString(),a=r.epoch_;return/12:00\s?AM/i.test(s)?(a=r.epoch_+86400,s="00:00:00"):s=n(e(s)),i(a,s)}function s(t,i,s){if("undefined"!=typeof t.timeNoDate&&(i&&!i.exists()||!i)){for(var a=0;a<t.timeNoDate.length&&(!i||!i.exists());a+=1)i=s.getSpan().innerCapture(t.timeNoDate[a],1);if(i.exists()){var u=i.toString(),l=e(u);return u=l?n(l):null,u=r(i,s),n(l),u}}}function a(t,e){return e.innerAbsoluteDate().exists()?t.trim().toString()===e.toString()?t.nextAbsoluteDateFromEnd():t.collapseToInnerEnd(e.toString()).nextAbsoluteDate():t.innerAbsoluteDate().exists()?t.innerAbsoluteDate():t.nextAbsoluteDate()}return function(t,e,n,i){function r(e,n){if("undefined"!=typeof t.skipDate&&e&&e.exists())for(x=0;x<t.skipDate.length&&e&&e.exists();x+=1){for(var i=n.next(t.skipDate[x]),r=!1;i.exists();)i.exists()&&i.getStart()<=e.getStart()&&i.getEnd()>e.getStart()&&(e=e.nextAbsoluteDate(),r=!0),i=i.next(t.skipDate[x]);e.exists()&&r&&(x=-1)}return e}function u(n,i){if("undefined"!=typeof t.skipStartDate){for(x=0;x<t.skipStartDate.length;x++)if(e.getSpan().next(t.skipStartDate[x]).exists()){var r=e.getSpan().next(t.skipStartDate[x]).start_,s=e.getSpan().next(t.skipStartDate[x]).end_;if(n&&n.exists()&&!i){var a=n.exists()&&n.start_?n.start_:null,u=n.exists()&&n.end_?n.end_:null;r&&u&&a>r&&u<=s&&(n=null)}else if(n&&n.exists()&&i){var l=n.nextDate().exists()&&n.nextDate().start_?n.nextDate().start_:null,o=n.nextDate().exists()&&n.nextDate().end_?n.nextDate().end_:null;n=n.nextDate().exists()&&r&&o&&!(l>r&&o<=s)?n.nextDate():null}}if(!i)return null===n;if(i)return null===n?null:n}}function l(n){function i(n){for(x=0;x<t.skipTime.length;x++){var i=e.getSpan().next(t.skipTime[x]);if(i.exists()&&i.getStart()<=n.getStart()&&i.getEnd()>n.getStart())return!0}return!1}for(var r=null!==n?n.length:0,s=0;s<r;s++){var a=n[s];if(hasTime(a)){if(/^00/.test(a.toString()))break;if(t.skipTime&&t.skipTime.length>0&&i(a))continue;return a}}return null}var o,x,f,g;if("undefined"!=typeof t.dateCapture)for(x=0;x<t.dateCapture.length&&(!f||!f.exists());x++)if((o=e.getSpan().innerCapture(t.dateCapture[x],1))&&(f=o.innerDate()).exists())return f;var d=e.getSpan().allAbsoluteDates().filter(function(n){return/[\d\uff10-\uff19]{1,2}/.test(n.toString())&&(!(i&&i.exists())||i&&i.exists()&&!i.toString().includes(n.toString()))&&!t.footer.map(function(t){return e.getSpan().next(t)}).filter(function(t){return t.exists()}).some(function(t){return t.contains(n)})});if(0===d.length){if(n&&(!f||!f.exists())){var p=n.subject.replace(/\r?\n/gm," ").replace(/\s+/g," "),D=e.getDetachedSpan(p);f=D.innerAbsoluteDate(),i&&i.exists()&&i.toString().includes(f.toString())&&(f=e.getNullSpan()),(f=r(f,D))&&f.exists()&&!hasTime(f)&&(g=l(d=e.getSpan().allDates().filter(function(t){return/[\d\uff10-\uff19]{1,2}/.test(t.toString())})))&&(f=combineDateAndTime(f,g))}if(n&&i&&i.exists()&&(!f||!f.exists())){var S=t.buildRegExp("dateCaptureHTMLFromName",i.toString());for(x=0;x<S.length&&(!f||!f.exists());x++){(c=S[x].exec(n.html))&&2===c.length&&(f=e.getDetachedSpan(c[1]).innerDate())}}if(n&&(!f||!f.exists())&&"undefined"!=typeof t.dateCaptureHTML)for(x=0;x<t.dateCaptureHTML.length&&(!f||!f.exists());x++){var c;(c=t.dateCaptureHTML[x].exec(n.html))&&2===c.length&&(f=e.getDetachedSpan(c[1]).innerDate())}var m,h;if(f&&f.exists()&&!hasTime(f)&&"undefined"!=typeof t.timeCaptureHTML)for(x=0;x<t.timeCaptureHTML.length&&(!m||!m.exists());x++){var v=t.timeCaptureHTML[x].exec(n.html);v&&2===v.length&&(m=e.getDetachedSpan(v[1]).innerDate())&&m.exists()&&(f=combineDateAndTime(f,m))}if(null!==(h=s(t,f,e)?s(t,f,e):null))return h;if(n&&(!f||!f.exists())&&i&&i.exists()&&(f=/[\d\uff10-\uff19]{1,2}/.test(i.innerDate().toString())&&!/^[\d\uff10-\uff19]{1,2}(?:\:[\d\uff10-\uff19]+\s*?)?(?:[ap]\.?m\.?)?$/.test(i.innerDate().toString())?i.innerDate():e.getNullSpan())&&f.exists())return f}if(null!==(h=s(t,f,e)?s(t,f,e):null))return h;if(i&&i.exists()){var T=t.buildRegExp("dateFromEventName",i.toString());for(x=0;x<T.length&&(!o||!o.exists());x++){for(var b=e.getSpan().next(T[x]),A=a(b,i);A.exists()&&(A.start_-b.end_>=350||A.toString()===i.innerAbsoluteDate().toString());)A=a(b=b.next(T[x]),i);(o=A).exists()&&(f=!1===u(o,!1)?o:null)&&f.exists()}}if("undefined"!=typeof t.date)for(x=0;x<t.date.length&&(!o||!o.exists());x++)(o=e.getSpan().next(t.date[x]).nextAbsoluteDate()).exists()&&(f=r(o,e.getSpan()));return f&&f.exists()||(f=!1===u(f=0!==d.length?d.shift():f,!1)?f:null)&&f.exists()&&e.getDateDD(f).endIso8601.length>0&&(f&&f.exists(),f=e.getDetachedSpan(e.getDateDD(f).iso8601).innerDate()),(f=r(f,e.getSpan()))&&f.exists()&&!hasTime(f)&&(g=l(d=e.getSpan().withStart(f.getEnd()).allDates().filter(function(t){return/[\d\uff10-\uff19]{1,2}/.test(t.toString())})))&&(f=combineDateAndTime(f,g)),f}}).call();