{
  "storage": "unilm_cpu.espresso.weights",
  "analyses": {
    "N8Espresso23analysis_debug_metadataE": {
      "path": "",
      "bundle": "",
      "product": "",
      "use_case": "",
      "name": "LOCALHOST-2023-07-14-CPU-quant",
      "version": "ips7hpjvpj_5400"
    }
  },
  "properties": {
    "fast_reshape": "1"
  },
  "format_version": 200,
  "metadata_in_weights": [],
  "layers": [
    {
      "nB": 15000,
      "top": "embed_out",
      "has_biases": 0,
      "weights": {
        "Q": 1,
        "Qscale_t": 3,
        "W_t_int8": 5
      },
      "nC": 512,
      "is_lookup": 1,
      "quantization_mode": 2,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "input",
      "debug_info": "",
      "has_tanh": 0,
      "name": "embed",
      "has_prelu": 0
    },
    {
      "nB": 256,
      "top": "embed_position_out",
      "has_biases": 0,
      "weights": {
        "Q": 1,
        "Qscale_t": 7,
        "W_t_int8": 9
      },
      "nC": 512,
      "is_lookup": 1,
      "quantization_mode": 2,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "position",
      "debug_info": "",
      "has_tanh": 0,
      "name": "embed_position",
      "has_prelu": 0
    },
    {
      "nB": 2,
      "top": "embed_segment_out",
      "has_biases": 0,
      "weights": {
        "Q": 1,
        "Qscale_t": 11,
        "W_t_int8": 13
      },
      "nC": 512,
      "is_lookup": 1,
      "quantization_mode": 2,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "segment",
      "debug_info": "",
      "has_tanh": 0,
      "name": "embed_segment",
      "has_prelu": 0
    },
    {
      "bottom": "embed_position_out,embed_segment_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "embed_pos_seg_out",
      "type": "elementwise",
      "name": "embed_pos_seg",
      "beta": 0
    },
    {
      "bottom": "embed_out,embed_pos_seg_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "add_out",
      "type": "elementwise",
      "name": "add",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "add_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 15,
        "wGamma": 17
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_0:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 19
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_0:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_0:query_fc/output_raw,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_0:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_0:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_0:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 21,
        "Qscale": 23
      },
      "debug_info": "",
      "top": "self_attention_0:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_0:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_0:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 25
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_0:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_0:key_fc/output_raw,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_0:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_0:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_0:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 27,
        "Qscale": 29
      },
      "debug_info": "",
      "top": "self_attention_0:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_0:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_0:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 31
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_0:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_0:value_fc/output_raw,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_0:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_0:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_0:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 33,
        "Qscale": 35
      },
      "debug_info": "",
      "top": "self_attention_0:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_0:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_0:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_0:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_0:query_reshaped"
    },
    {
      "name": "self_attention_0:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_0:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_0:key_reshaped"
    },
    {
      "name": "self_attention_0:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_0:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_0:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_0:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_0:query_t",
      "type": "transpose",
      "name": "self_attention_0:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_0:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_0:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_0:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_0:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_k_s_in,ane_gpt2_transformer_layer_3d/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_0:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_0:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_v_s_in,ane_gpt2_transformer_layer_3d/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_0:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_0:value_state_concat"
    },
    {
      "bottom": "self_attention_0:query_t,self_attention_0:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_0:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_0:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_0:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_0:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_0:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_0:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_0:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_0:softmax"
    },
    {
      "bottom": "self_attention_0:softmax,self_attention_0:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_0:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_0:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_0:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_0:context_t",
      "type": "transpose",
      "name": "self_attention_0:context_t"
    },
    {
      "name": "self_attention_0:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_0:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out,ane_gpt2_transformer_layer_3d/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 37
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/attn_fc/output_raw,ane_gpt2_transformer_layer_3d/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d/attn_out/act_scale_per_token",
      "weights": {
        "biases": 39,
        "Qscale": 41
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "add_out,ane_gpt2_transformer_layer_3d/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 43,
        "wGamma": 45
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 47
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ffn/output_raw,ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 49,
        "Qscale": 51
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/act_out,ane_gpt2_transformer_layer_3d/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 53
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ffn_1/output_raw,ane_gpt2_transformer_layer_3d/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d/act_out/act_scale_per_token",
      "weights": {
        "biases": 55,
        "Qscale": 57
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/ffn_1_out,ane_gpt2_transformer_layer_3d/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 59,
        "wGamma": 61
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_1:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 63
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_1:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_1:query_fc/output_raw,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_1:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_1:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_1:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 65,
        "Qscale": 67
      },
      "debug_info": "",
      "top": "self_attention_1:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_1:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_1:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 69
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_1:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_1:key_fc/output_raw,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_1:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_1:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_1:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 71,
        "Qscale": 73
      },
      "debug_info": "",
      "top": "self_attention_1:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_1:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_1:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 75
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_1:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_1:value_fc/output_raw,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_1:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_1:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_1:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 77,
        "Qscale": 79
      },
      "debug_info": "",
      "top": "self_attention_1:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_1:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_1:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_1:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_1:query_reshaped"
    },
    {
      "name": "self_attention_1:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_1:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_1:key_reshaped"
    },
    {
      "name": "self_attention_1:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_1:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_1:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_1:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_1:query_t",
      "type": "transpose",
      "name": "self_attention_1:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_1:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_1:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_1:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_1:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_k_s_in,ane_gpt2_transformer_layer_3d_1/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_1:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_1:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_v_s_in,ane_gpt2_transformer_layer_3d_1/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_1:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_1:value_state_concat"
    },
    {
      "bottom": "self_attention_1:query_t,self_attention_1:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_1:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_1:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_1:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_1:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_1:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_1:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_1:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_1:softmax"
    },
    {
      "bottom": "self_attention_1:softmax,self_attention_1:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_1:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_1:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_1:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_1:context_t",
      "type": "transpose",
      "name": "self_attention_1:context_t"
    },
    {
      "name": "self_attention_1:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_1:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out,ane_gpt2_transformer_layer_3d_1/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_1/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_1/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 81
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_1/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_fc/output_raw,ane_gpt2_transformer_layer_3d_1/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/attn_out/act_scale_per_token",
      "weights": {
        "biases": 83,
        "Qscale": 85
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_1/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d/residual_ffn_out,ane_gpt2_transformer_layer_3d_1/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_1/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 87,
        "wGamma": 89
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_1/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 91
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_1/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn/output_raw,ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 93,
        "Qscale": 95
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_1/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d_1/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_1/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_1/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out,ane_gpt2_transformer_layer_3d_1/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d_1/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_1/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d_1/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 97
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_1/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_1/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn_1/output_raw,ane_gpt2_transformer_layer_3d_1/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d_1/act_out/act_scale_per_token",
      "weights": {
        "biases": 99,
        "Qscale": 101
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_1/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/ffn_1_out,ane_gpt2_transformer_layer_3d_1/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_1/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_1/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_1/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 103,
        "wGamma": 105
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_2:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 107
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_2:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_2:query_fc/output_raw,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_2:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_2:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_2:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 109,
        "Qscale": 111
      },
      "debug_info": "",
      "top": "self_attention_2:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_2:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_2:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 113
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_2:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_2:key_fc/output_raw,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_2:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_2:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_2:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 115,
        "Qscale": 117
      },
      "debug_info": "",
      "top": "self_attention_2:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_2:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_2:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 119
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_2:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_2:value_fc/output_raw,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_2:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_2:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_2:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 121,
        "Qscale": 123
      },
      "debug_info": "",
      "top": "self_attention_2:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_2:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_2:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_2:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_2:query_reshaped"
    },
    {
      "name": "self_attention_2:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_2:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_2:key_reshaped"
    },
    {
      "name": "self_attention_2:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_2:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_2:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_2:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_2:query_t",
      "type": "transpose",
      "name": "self_attention_2:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_2:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_2:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_2:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_2:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_k_s_in,ane_gpt2_transformer_layer_3d_2/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_2:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_2:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_v_s_in,ane_gpt2_transformer_layer_3d_2/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_2:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_2:value_state_concat"
    },
    {
      "bottom": "self_attention_2:query_t,self_attention_2:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_2:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_2:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_2:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_2:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_2:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_2:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_2:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_2:softmax"
    },
    {
      "bottom": "self_attention_2:softmax,self_attention_2:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_2:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_2:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_2:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_2:context_t",
      "type": "transpose",
      "name": "self_attention_2:context_t"
    },
    {
      "name": "self_attention_2:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_2:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out,ane_gpt2_transformer_layer_3d_2/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_2/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_2/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 125
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_2/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_fc/output_raw,ane_gpt2_transformer_layer_3d_2/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/attn_out/act_scale_per_token",
      "weights": {
        "biases": 127,
        "Qscale": 129
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_2/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_1/residual_ffn_out,ane_gpt2_transformer_layer_3d_2/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_2/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 131,
        "wGamma": 133
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_2/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 135
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_2/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn/output_raw,ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 137,
        "Qscale": 139
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_2/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d_2/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_2/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_2/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out,ane_gpt2_transformer_layer_3d_2/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d_2/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_2/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d_2/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 141
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_2/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_2/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn_1/output_raw,ane_gpt2_transformer_layer_3d_2/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d_2/act_out/act_scale_per_token",
      "weights": {
        "biases": 143,
        "Qscale": 145
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_2/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/ffn_1_out,ane_gpt2_transformer_layer_3d_2/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_2/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_2/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_2/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 147,
        "wGamma": 149
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_3:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 151
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_3:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_3:query_fc/output_raw,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_3:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_3:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_3:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 153,
        "Qscale": 155
      },
      "debug_info": "",
      "top": "self_attention_3:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_3:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_3:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 157
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_3:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_3:key_fc/output_raw,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_3:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_3:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_3:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 159,
        "Qscale": 161
      },
      "debug_info": "",
      "top": "self_attention_3:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_3:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_3:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 163
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_3:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_3:value_fc/output_raw,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_3:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_3:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_3:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 165,
        "Qscale": 167
      },
      "debug_info": "",
      "top": "self_attention_3:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_3:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_3:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_3:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_3:query_reshaped"
    },
    {
      "name": "self_attention_3:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_3:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_3:key_reshaped"
    },
    {
      "name": "self_attention_3:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_3:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_3:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_3:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_3:query_t",
      "type": "transpose",
      "name": "self_attention_3:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_3:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_3:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_3:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_3:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_k_s_in,ane_gpt2_transformer_layer_3d_3/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_3:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_3:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_v_s_in,ane_gpt2_transformer_layer_3d_3/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_3:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_3:value_state_concat"
    },
    {
      "bottom": "self_attention_3:query_t,self_attention_3:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_3:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_3:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_3:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_3:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_3:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_3:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_3:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_3:softmax"
    },
    {
      "bottom": "self_attention_3:softmax,self_attention_3:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_3:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_3:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_3:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_3:context_t",
      "type": "transpose",
      "name": "self_attention_3:context_t"
    },
    {
      "name": "self_attention_3:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_3:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out,ane_gpt2_transformer_layer_3d_3/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_3/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_3/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 169
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_3/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_fc/output_raw,ane_gpt2_transformer_layer_3d_3/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/attn_out/act_scale_per_token",
      "weights": {
        "biases": 171,
        "Qscale": 173
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_3/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_2/residual_ffn_out,ane_gpt2_transformer_layer_3d_3/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_3/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 175,
        "wGamma": 177
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_3/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 179
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_3/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn/output_raw,ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 181,
        "Qscale": 183
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_3/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d_3/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_3/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_3/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out,ane_gpt2_transformer_layer_3d_3/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d_3/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_3/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d_3/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 185
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_3/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_3/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn_1/output_raw,ane_gpt2_transformer_layer_3d_3/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d_3/act_out/act_scale_per_token",
      "weights": {
        "biases": 187,
        "Qscale": 189
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_3/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/ffn_1_out,ane_gpt2_transformer_layer_3d_3/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_3/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_3/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_3/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 191,
        "wGamma": 193
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_4:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 195
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_4:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_4:query_fc/output_raw,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_4:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_4:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_4:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 197,
        "Qscale": 199
      },
      "debug_info": "",
      "top": "self_attention_4:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_4:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_4:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 201
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_4:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_4:key_fc/output_raw,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_4:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_4:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_4:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 203,
        "Qscale": 205
      },
      "debug_info": "",
      "top": "self_attention_4:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_4:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_4:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 207
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_4:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_4:value_fc/output_raw,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_4:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_4:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_4:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 209,
        "Qscale": 211
      },
      "debug_info": "",
      "top": "self_attention_4:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_4:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_4:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_4:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_4:query_reshaped"
    },
    {
      "name": "self_attention_4:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_4:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_4:key_reshaped"
    },
    {
      "name": "self_attention_4:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_4:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_4:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_4:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_4:query_t",
      "type": "transpose",
      "name": "self_attention_4:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_4:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_4:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_4:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_4:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_k_s_in,ane_gpt2_transformer_layer_3d_4/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_4:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_4:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_v_s_in,ane_gpt2_transformer_layer_3d_4/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_4:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_4:value_state_concat"
    },
    {
      "bottom": "self_attention_4:query_t,self_attention_4:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_4:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_4:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_4:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_4:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_4:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_4:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_4:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_4:softmax"
    },
    {
      "bottom": "self_attention_4:softmax,self_attention_4:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_4:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_4:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_4:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_4:context_t",
      "type": "transpose",
      "name": "self_attention_4:context_t"
    },
    {
      "name": "self_attention_4:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_4:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out,ane_gpt2_transformer_layer_3d_4/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_4/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_4/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 213
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_4/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_fc/output_raw,ane_gpt2_transformer_layer_3d_4/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/attn_out/act_scale_per_token",
      "weights": {
        "biases": 215,
        "Qscale": 217
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_4/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_3/residual_ffn_out,ane_gpt2_transformer_layer_3d_4/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_4/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 219,
        "wGamma": 221
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_4/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 223
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_4/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn/output_raw,ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 225,
        "Qscale": 227
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_4/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d_4/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_4/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_4/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out,ane_gpt2_transformer_layer_3d_4/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d_4/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_4/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d_4/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 229
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_4/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_4/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn_1/output_raw,ane_gpt2_transformer_layer_3d_4/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d_4/act_out/act_scale_per_token",
      "weights": {
        "biases": 231,
        "Qscale": 233
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_4/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/ffn_1_out,ane_gpt2_transformer_layer_3d_4/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_4/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_4/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_4/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out_after_input_transpose",
      "weights": {
        "wBeta": 235,
        "wGamma": 237
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_5:query_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 239
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_5:query_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_5:query_fc/output_raw,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_5:query_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_5:query_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_5:query_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 241,
        "Qscale": 243
      },
      "debug_info": "",
      "top": "self_attention_5:query_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_5:query_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_5:key_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 245
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_5:key_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_5:key_fc/output_raw,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_5:key_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_5:key_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_5:key_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 247,
        "Qscale": 249
      },
      "debug_info": "",
      "top": "self_attention_5:key_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_5:key_fc/dequantize",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "self_attention_5:value_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 251
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "self_attention_5:value_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "self_attention_5:value_fc/output_raw,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_5:value_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "self_attention_5:value_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "self_attention_5:value_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_attn_out/act_scale_per_token",
      "weights": {
        "biases": 253,
        "Qscale": 255
      },
      "debug_info": "",
      "top": "self_attention_5:value_fc",
      "type": "dynamic_dequantize",
      "name": "self_attention_5:value_fc/dequantize",
      "simple_mode": 1
    },
    {
      "name": "self_attention_5:query_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_5:query_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_5:query_reshaped"
    },
    {
      "name": "self_attention_5:key_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_5:key_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_5:key_reshaped"
    },
    {
      "name": "self_attention_5:value_reshape",
      "weights": {},
      "dst_w": 64,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_5:value_fc",
      "debug_info": "",
      "dst_seq": 0,
      "dst_k": 8,
      "top": "self_attention_5:value_reshaped"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_5:query_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_5:query_t",
      "type": "transpose",
      "name": "self_attention_5:query_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_5:key_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_k_s_out",
      "type": "transpose",
      "name": "self_attention_5:key_t"
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_5:value_reshaped",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_v_s_out",
      "type": "transpose",
      "name": "self_attention_5:value_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_k_s_in,ane_gpt2_transformer_layer_3d_5/attn_k_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_5:key_state_concat",
      "type": "general_concat",
      "name": "self_attention_5:key_state_concat"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_v_s_in,ane_gpt2_transformer_layer_3d_5/attn_v_s_out",
      "weights": {},
      "axis": 1,
      "debug_info": "",
      "top": "self_attention_5:value_state_concat",
      "type": "general_concat",
      "name": "self_attention_5:value_state_concat"
    },
    {
      "bottom": "self_attention_5:query_t,self_attention_5:key_state_concat",
      "weights": {},
      "transpose_y": true,
      "debug_info": "",
      "top": "self_attention_5:raw_score",
      "type": "batch_matmul",
      "name": "self_attention_5:raw_score",
      "channel_mode": false
    },
    {
      "bottom": "self_attention_5:raw_score",
      "alpha": 0.125,
      "operation": 3,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "self_attention_5:scaled_raw_score",
      "type": "elementwise",
      "name": "self_attention_5:scaled_raw_score",
      "beta": 0
    },
    {
      "bottom": "self_attention_5:scaled_raw_score",
      "weights": {},
      "nd_mode": true,
      "debug_info": "",
      "top": "self_attention_5:softmax",
      "C": 2,
      "type": "softmax",
      "name": "self_attention_5:softmax"
    },
    {
      "bottom": "self_attention_5:softmax,self_attention_5:value_state_concat",
      "weights": {},
      "debug_info": "",
      "top": "self_attention_5:weighted_avg",
      "type": "batch_matmul",
      "name": "self_attention_5:weighted_avg",
      "channel_mode": false
    },
    {
      "axis_h": 4,
      "axis_w": 0,
      "bottom": "self_attention_5:weighted_avg",
      "axis_k": 2,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "self_attention_5:context_t",
      "type": "transpose",
      "name": "self_attention_5:context_t"
    },
    {
      "name": "self_attention_5:context",
      "weights": {},
      "dst_w": 1,
      "version": 1,
      "dst_n": 0,
      "dst_nd_rank": 5,
      "type": "reshape",
      "dst_h": 1,
      "mode": 0,
      "bottom": "self_attention_5:context_t",
      "debug_info": "",
      "dst_seq": -1,
      "dst_k": 512,
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out,ane_gpt2_transformer_layer_3d_5/attn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_5/attn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_5/attn_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 257
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_5/attn_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_fc/output_raw,ane_gpt2_transformer_layer_3d_5/attn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/attn_fc/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/attn_out/act_scale_per_token",
      "weights": {
        "biases": 259,
        "Qscale": 261
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/attn_fc_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_5/attn_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_4/residual_ffn_out,ane_gpt2_transformer_layer_3d_5/attn_fc_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/residual_attn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/residual_attn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_5/residual_attn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out_after_input_transpose",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_input_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out_after_input_transpose",
      "weights": {
        "wBeta": 263,
        "wGamma": 265
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out",
      "type": "transpose",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_output_t"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out,ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/quantized_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "ane_gpt2_transformer_layer_3d_5/ffn/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 267
      },
      "nC": 2048,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_5/ffn/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn/output_raw,ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ffn/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ffn/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/ln_pre_ffn_out/act_scale_per_token",
      "weights": {
        "biases": 269,
        "Qscale": 271
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ffn_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_5/ffn/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/act_out",
      "type": "activation",
      "name": "ane_gpt2_transformer_layer_3d_5/act"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/act_out/abs",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/act_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "ane_gpt2_transformer_layer_3d_5/act_out/max_abs",
      "type": "reduce",
      "name": "ane_gpt2_transformer_layer_3d_5/act_out/normalize_per_token/max"
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/act_out/tok_scales",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/act_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out,ane_gpt2_transformer_layer_3d_5/act_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/act_out/scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/act_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/act_out/quantized_per_token,ane_gpt2_transformer_layer_3d_5/act_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "ane_gpt2_transformer_layer_3d_5/act_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 2048,
      "top": "ane_gpt2_transformer_layer_3d_5/ffn_1/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 273
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "ane_gpt2_transformer_layer_3d_5/act_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "ane_gpt2_transformer_layer_3d_5/ffn_1/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn_1/output_raw,ane_gpt2_transformer_layer_3d_5/act_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ffn_1/output_scaled_per_token",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/ffn_1/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn_1/output_scaled_per_token,ane_gpt2_transformer_layer_3d_5/act_out/act_scale_per_token",
      "weights": {
        "biases": 275,
        "Qscale": 277
      },
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/ffn_1_out",
      "type": "dynamic_dequantize",
      "name": "ane_gpt2_transformer_layer_3d_5/ffn_1/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "ane_gpt2_transformer_layer_3d_5/ffn_1_out,ane_gpt2_transformer_layer_3d_5/residual_attn_out",
      "alpha": 1,
      "operation": 0,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "ane_gpt2_transformer_layer_3d_5/residual_ffn_out",
      "type": "elementwise",
      "name": "ane_gpt2_transformer_layer_3d_5/residual_ffn",
      "beta": 0
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "ane_gpt2_transformer_layer_3d_5/residual_ffn_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "decoder/ln_final_out_after_input_transpose",
      "type": "transpose",
      "name": "decoder/ln_final_input_t"
    },
    {
      "bottom": "decoder/ln_final_out_after_input_transpose",
      "weights": {
        "wBeta": 279,
        "wGamma": 281
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "decoder/ln_final_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "decoder/ln_final",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "decoder/ln_final_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "decoder/ln_final_out",
      "type": "transpose",
      "name": "decoder/ln_final_output_t"
    },
    {
      "bottom": "decoder/ln_final_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "decoder/ln_final_out/abs",
      "type": "elementwise",
      "name": "decoder/ln_final_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "decoder/ln_final_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "decoder/ln_final_out/max_abs",
      "type": "reduce",
      "name": "decoder/ln_final_out/normalize_per_token/max"
    },
    {
      "bottom": "decoder/ln_final_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "decoder/ln_final_out/tok_scales",
      "type": "elementwise",
      "name": "decoder/ln_final_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "decoder/ln_final_out,decoder/ln_final_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "decoder/ln_final_out/scaled_per_token",
      "type": "elementwise",
      "name": "decoder/ln_final_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "decoder/ln_final_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "decoder/ln_final_out/quantized_per_token,decoder/ln_final_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "decoder/ln_final_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "lm_head/transform/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 283
      },
      "nC": 512,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "decoder/ln_final_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "lm_head/transform/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "lm_head/transform/output_raw,decoder/ln_final_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "lm_head/transform/output_scaled_per_token",
      "type": "elementwise",
      "name": "lm_head/transform/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "lm_head/transform/output_scaled_per_token,decoder/ln_final_out/act_scale_per_token",
      "weights": {
        "biases": 285,
        "Qscale": 287
      },
      "debug_info": "",
      "top": "lm_head/transform_out",
      "type": "dynamic_dequantize",
      "name": "lm_head/transform/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "lm_head/transform_out",
      "weights": {},
      "mode": 22,
      "debug_info": "",
      "top": "lm_head/act_out",
      "type": "activation",
      "name": "lm_head/act"
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "lm_head/act_out",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "lm_head/lnorm_out_after_input_transpose",
      "type": "transpose",
      "name": "lm_head/lnorm_input_t"
    },
    {
      "bottom": "lm_head/lnorm_out_after_input_transpose",
      "weights": {
        "wBeta": 289,
        "wGamma": 291
      },
      "eps": 9.999999747378752e-06,
      "tf_layernorm": 1,
      "debug_info": "",
      "top": "lm_head/lnorm_out_after_output_transpose",
      "type": "instancenorm_1d",
      "name": "lm_head/lnorm",
      "eps_in_square_root": 1
    },
    {
      "axis_h": 4,
      "axis_w": 2,
      "bottom": "lm_head/lnorm_out_after_output_transpose",
      "axis_k": 0,
      "axis_n": 3,
      "axis_seq": 1,
      "weights": {},
      "debug_info": "",
      "top": "lm_head/lnorm_out",
      "type": "transpose",
      "name": "lm_head/lnorm_output_t"
    },
    {
      "bottom": "lm_head/lnorm_out",
      "alpha": 1,
      "operation": 24,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "lm_head/lnorm_out/abs",
      "type": "elementwise",
      "name": "lm_head/lnorm_out/normalize_per_token/abs",
      "beta": 0
    },
    {
      "bottom": "lm_head/lnorm_out/abs",
      "weights": {},
      "mode": 9,
      "debug_info": "",
      "use_version": 1,
      "top": "lm_head/lnorm_out/max_abs",
      "type": "reduce",
      "name": "lm_head/lnorm_out/normalize_per_token/max"
    },
    {
      "bottom": "lm_head/lnorm_out/max_abs",
      "alpha": 9.999999974752427e-07,
      "operation": 119,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "lm_head/lnorm_out/tok_scales",
      "type": "elementwise",
      "name": "lm_head/lnorm_out/normalize_per_token/clip",
      "beta": 1000000
    },
    {
      "bottom": "lm_head/lnorm_out,lm_head/lnorm_out/tok_scales",
      "alpha": 1,
      "operation": 102,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "lm_head/lnorm_out/scaled_per_token",
      "type": "elementwise",
      "name": "lm_head/lnorm_out/normalize_per_token/div",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "lm_head/lnorm_out/scaled_per_token",
      "weights": {},
      "debug_info": "",
      "top": "lm_head/lnorm_out/quantized_per_token,lm_head/lnorm_out/act_scale_per_token",
      "type": "dynamic_quantize",
      "name": "lm_head/lnorm_out/quantize_per_token",
      "simple_mode": 1
    },
    {
      "nB": 512,
      "top": "final_fc/output_raw",
      "has_biases": 0,
      "weights": {
        "W_int8": 5
      },
      "nC": 15000,
      "quantization_mode": 5,
      "type": "inner_product",
      "has_relu": 0,
      "bottom": "lm_head/lnorm_out/quantized_per_token",
      "debug_info": "",
      "has_tanh": 0,
      "name": "final_fc/quantized",
      "has_prelu": 0
    },
    {
      "bottom": "final_fc/output_raw,lm_head/lnorm_out/tok_scales",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "top": "final_fc/output_scaled_per_token",
      "type": "elementwise",
      "name": "final_fc/scale_tokens",
      "beta": 0
    },
    {
      "dst_cp": -1,
      "bottom": "final_fc/output_scaled_per_token,lm_head/lnorm_out/act_scale_per_token",
      "weights": {
        "Qscale": 3
      },
      "debug_info": "",
      "top": "final_fc_out",
      "type": "dynamic_dequantize",
      "name": "final_fc/dequantize",
      "simple_mode": 1
    },
    {
      "bottom": "final_fc_out,temperature",
      "alpha": 1,
      "operation": 1,
      "weights": {},
      "fused_relu": 0,
      "debug_info": "",
      "nd_mode": true,
      "top": "final_fc_scale_out",
      "type": "elementwise",
      "name": "final_fc_scale",
      "beta": 0
    },
    {
      "bottom": "final_fc_scale_out",
      "weights": {},
      "debug_info": "",
      "top": "output",
      "C": 2,
      "type": "softmax",
      "name": "final_fc_softmax"
    }
  ]
}
