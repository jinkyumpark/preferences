(function(){return function(e,t,r){var a,o=loadHelper("helper_vocabulary.js");if(/booking\.lufthansa.com/.test(t.from)&&e.reservationFor.departureTime&&!/\d{4}-\d{2}-\d{2}/.test(e.reservationFor.departureTime))return CONTINUE;if(/lufthansa.com/.test(t.from)&&e.reservationFor.boardingTime&&e.reservationFor.departureTime&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}\+\d{2}:\d{2}/.exec(e.reservationFor.boardingTime)&&/\d{4}-\d{2}-\d{2}/.exec(e.reservationFor.departureTime)&&(e.reservationFor.departureTime=e.reservationFor.boardingTime),/mail\.volotea\.com/i.test(t.from)&&Array.isArray(e.potentialAction)&&(e.potentialAction=null),/lastminute.com/.test(t.from)&&Array.isArray(e.reservationFor))return CONTINUE;if(/easyjet.com/.test(t.from)&&e.reservationFor){var n=e.reservationFor.airline.iataCode;if(3===n.length){var i=loadHelper("airline.js"),s=loadHelper("airlines.js");e.reservationFor.airline.iataCode=i.airlineFromReference(n,s).IATA}}if(/atrapalo.com/.test(t.from)&&(/\//.test(e.checkinDate)||/\//.test(e.checkoutDate))&&((U=Scanner.fromMessage(t)).setLocale(r),e.checkinDate=unSpanDate_(U.getDetachedSpan(e.checkinDate).innerDate()),e.checkoutDate=unSpanDate_(U.getDetachedSpan(e.checkoutDate).innerDate())),/hotel\.de/.test(t.from)&&e.reservationFor&&e.lodgingUnitType&&e.lodgingUnitType instanceof Array&&(e.lodgingUnitType=null),/vueling.com/.test(t.from)&&!e.reservationFor)return CONTINUE;if(/govoyages.com/.test(t.from)&&!e.reservationFor)return CONTINUE;if(/noti.swiss.com/.test(t.from)&&(e.potentialAction&&delete e.potentialAction,e.reservationFor&&e.reservationFor.departureTime&&(e.reservationFor.departureTime=/^\d{4}-\d{2}-\d{2}T\d{1,2}\:\d{2}$/.test(e.reservationFor.departureTime)?e.reservationFor.departureTime.concat(":00"):e.reservationFor.departureTime),/Cancellation Confirmation|Confirmaci\xf3n de cancelaci\xf3n/.test(t.subject)&&(delete e.reservationFor.arrivalTime,e.reservationStatus="http://schema.org/ReservationCancelled")),/hopper.com/.test(t.from)&&"http://schema.org/RentalCarReservation"===e["@type"])return CONTINUE;if(/hopper.com/.test(t.from)&&e.reservationFor){if((U=Scanner.fromMessage(t)).setLocale(r),e.checkinDate&&e.checkoutDate&&(e.checkinDate=unSpanDate_(U.getDetachedSpan(e.checkinDate).innerDate()),e.checkoutDate=unSpanDate_(U.getDetachedSpan(e.checkoutDate).innerDate())),e.reservationNumber&&e.reservationNumber instanceof Array&&(e.reservationNumber=e.reservationNumber[0]),!/T\d+/.test(e.checkinDate)){var c=regExpFormatted(/Check\sIn:\1.+?at\s(\d{1,2}:\d{2})/i,o.monochrome.tablePassLight),d=c.test(t.plain)?U.getDetachedSpan(c.exec(t.plain)[1]):null;e.checkinDate=d?combineDateAndTime(e.checkinDate,d):e.checkinDate}if(!/T\d+/.test(e.checkoutDate)){var m=regExpFormatted(/Check\sOut:\1.+?at\s(\d{1,2}:\d{2})/i,o.monochrome.tablePassLight),l=m.test(t.plain)?U.getDetachedSpan(m.exec(t.plain)[1]):null;e.checkoutDate=l?combineDateAndTime(e.checkoutDate,l):e.checkoutDate}}if(/notifications\.swiss\.com/i.test(t.from)&&Array.isArray(e.potentialAction)&&(e.potentialAction=null),/hrs\.de/.test(t.from)&&"de_DE"===r){if((U=Scanner.fromMessage(t)).setLocale(r),/^T\d+/.exec(e.checkinDate))if((v=U.getSpan().next(/Anreise \/ Abreise/).nextDate())&&/-/.exec(v)){var p=unSpanDate_(v.split(/-/)[0]),f=unSpanDate_(v.split(/-/)[1]);e.checkinDate=unSpanDate_(U.getDetachedSpan(p).innerDate()),e.checkoutDate=unSpanDate_(U.getDetachedSpan(f).innerDate())}if(/\d+T00.+/.exec(e.checkinDate)){var u=U.getSpan().next(/Fr\xfchester Check-In/).nextDate();e.checkinDate=combineDateAndTime(e.checkinDate,u)}}if(/hrs.com/.test(t.from)){var v;if((U=Scanner.fromMessage(t)).setLocale(r),/^T\d+/.exec(e.checkinDate))(v=U.getSpan().next(/Arrival \/ Departure.+?-.+?(?=\[)/i).allDates())&&2===v.length&&(e.checkinDate=unSpanDate_(v[0]),e.checkoutDate=unSpanDate_(v[1]));if(/\d+T00.+/.exec(e.checkinDate)){u=U.getSpan().next(/Earliest Check-In/i).nextDate();e.checkinDate=combineDateAndTime(e.checkinDate,u)}if(/\d+T00.+/.exec(e.checkoutDate)){var g=U.getSpan().next(/Latest Check-Out/i).nextDate();e.checkoutDate=g.exists()?combineDateAndTime(e.checkoutDate,g):e.checkoutDate.split("T")[0]}}if(/ryanair.com/.test(t.from)&&((U=Scanner.fromMessage(t)).setLocale(r),!e.reservationFor.arrivalAirport.iataCode.length)){var h=new RegExp("\\("+e.reservationFor.departureAirport.iataCode+"\\) - \\(([A-Z]{3})\\)"),D=U.getSpan().next(h).innerCapture(h,1);e.reservationFor.arrivalAirport.iataCode=D}if(/edreams\.\w{2}/.test(t.from)&&!e.reservationFor)return CONTINUE;if(/thy.com/.test(t.from)&&/Cancellation Message/i.test(t.subject)&&(e.reservationStatus="http://schema.org/ReservationCancelled"),/koreanair.co.kr/.test(t.from)&&Array.isArray(e.reservationFor.departureTime))return CONTINUE;if(/flytap.com/.test(t.from)&&/Your Boarding Pass Confirmation/.test(t.subject))return CONTINUE;if(/tap.pt/.test(t.from))return CONTINUE;if(/flyasiana.com/.test(t.from)&&/\/.+?\//.test(e.reservationFor))return CONTINUE;if(/aircanada.ca/.test(t.from)&&/\+00:00/.test(e.reservationFor.departureTime))return CONTINUE;if(/edreams.it/i.test(t.from)&&!e.reservationFor)return CONTINUE;if(/stubhub.com/i.test(t.from)){if(!e.reservationNumber||""===e.reservationNumber)return CONTINUE;e.venueSeat&&Array.isArray(e.venueSeat)&&(e.venueSeat=e.venueSeat.join(","))}(/seatme\.yelp\.com/i.test(t.from)&&(e.startTime=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}))$/.test(e.startTime)?e.startTime.concat(":00"):e.startTime,delete e.modifiedTime),/ugcmailing.fr/i.test(t.from)&&(e.reservationFor.name&&(e.reservationFor.movie={name:e.reservationFor.name,"@type":"http://schema.org/Movie"},delete e.reservationFor.name),e.reservationFor["@type"]&&"http://schema.org/Event"===e.reservationFor["@type"]&&(e.reservationFor["@type"]="http://schema.org/MovieShowing"),(U=Scanner.fromMessage(t)).setLocale("fr_FR"),e.reservationFor.startDate&&/\d{1,2}\/\d{1,2}\/\d{4}\s\xe0\s\d{1,2}\:\d{2}/.test(U.getSpan().firstDate())&&(e.reservationFor.startDate=combineDateAndTime(U.getSpan().firstDate()))),/universe\.com/i.test(t.from))&&((T=e.modifiedTime&&/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}\s\w+/.test(e.modifiedTime)?/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2})\s(\w+)/.exec(e.modifiedTime):null)[3]="UTC"===T[3]?"Z":T[3],e.modifiedTime=T?T[1].concat("T",T[2],T[3]):e.modifiedTime);if(/no-reply\@misiedo\.com/.test(t.from)){var T=/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}\s\+\d+/.test(e.startTime)?/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2}\s\+\d+)/.exec(e.startTime):null;e.startTime=T?T[1].concat("T",T[2]):e.startTime}if(/ticketea\.com/i.test(t.from)){if(e.modifiedTime){T=/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}/.test(e.modifiedTime)?/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2})/.exec(e.modifiedTime):null;e.modifiedTime=T?T[1].concat("T",T[2]):e.modifiedTime}e.price=!1===/,/.test(e.price)&&"EUR"===e.priceCurrency?null:e.price,e.priceCurrency=null===e.price?null:e.priceCurrency}if(/tiqets\.com/i.test(t.from)){if(e.modifiedTime){T=/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}(?:\.\d+)?/.test(e.modifiedTime)?/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2}(?:\.\d+)?)/.exec(e.modifiedTime):null;e.modifiedTime=T?T[1].concat("T",T[2]):e.modifiedTime}if(e.bookingTime)T=/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}(?:\.\d+)?/.test(e.bookingTime)?delete e.bookingTime:null}if(/getyourguide\.com/.test(t.from)){if((U=Scanner.fromMessage(t)).setLocale(r),e.reservationFor&&!e.reservationFor.startDate){var F=t.plain.replace(regExpFormatted(/[\s\S]+?\|\s+?(?:PIN(?:code|\u756a\u53f7)?|\u4e2a\u4eba\u8bc6\u522b\u7801|):?\s+?.+?\s\1\]\s(.+?)\s\|[\s\S]+/,o.monochrome.tablePassLight),"$1");if(F&&U.getSpan().allDates().length>0)for(var S=0;S<U.getSpan().allDates().length;S++)U.getSpan().allDates()[S].toString()===F&&(e.reservationFor.startDate=U.getSpan().allDates()[S]);else if(/\d{4}\W\d{1,2}\W\d{2}\W/.test(F))(ae=/(\d{4})\W(\d{1,2})\W(\d{2})\W(\d{1,2}:\d{2})?/.exec(F))&&ae[4]?e.reservationFor.startDate=ae[1]+"-"+ae[2]+"-"+ae[3]+"T"+ae[4]:ae&&!ae[4]&&(e.reservationFor.startDate=ae[1]+"-"+ae[2]+"-"+ae[3])}if(e.reservationFor&&!e.reservationFor.location){e.reservationFor.startDate||(e.reservationFor.startDate=U.getDetachedSpan(t.plain.replace(/\./g,"/")).firstDate());var k="ko_KR"===r?/\ubaa8\uc784 \uc7a5\uc18c \uc8fc\uc18c/:"zh_Hans_CN"===r?/(?:\u96c6\u5408\u9ede\u5730\u5740|\u96c6\u5408\u70b9\u5730\u5740)/:"ja_JP"===r?/\u96c6\u5408\u5834\u6240\u306e\u4f4f\u6240/:"en_US"===r?/Meeting point address/:"nl_NL"===r?/Adres trefpunt/:"es_ES"===r?/Direcci\xf3n del punto de encuentro/:"it_IT"===r?/Indirizzo del punto d'incontro/:"fr_FR"===r?/Adresse du point de rencontre/:"de_DE"===r?/Adresse des Treffpunktes/:null,x="ko_KR"===r?/\uc138\ubd80 \uc815\ubcf4/:"zh_Hans_CN"===r?/(?:\u8a73\u60c5|\u8be6\u60c5)/:"ja_JP"===r?/(?:\u8a73\u7d30|\u4f4f\u6240)/:"en_US"===r?/(?:Details|Address)/:"nl_NL"===r?/(?:Gegevens|Adres)/:"es_ES"===r?/(?:Detalles|Direcci\xf3n)/:"it_IT"===r?/(?:Dettagli|Indirizzo)/:"fr_FR"===r?/(?:D\xe9tails|Adresse)/:"de_DE"===r?/(?:Details|Adresse)/:null,b=regExpFormatted(/\1\2?(\3)\4\5/i,k,o.monochrome.tablePassLight,o.common.nonCJKWithSpecialCharsGreedy,o.monochrome.tablePassLightLink,x).test(t.plain)?regExpFormatted(/\1\2?(\3)\4\5/i,k,o.monochrome.tablePassLight,o.common.nonCJKWithSpecialCharsGreedy,o.monochrome.tablePassLightLink,x).exec(t.plain):null;e.reservationFor.address=b&&b[1]?b[1]:null}}if(/entradas.com/i.test(t.from)){e.reservationFor.location&&"MovieTheater"===e.reservationFor.location["@type"]&&(e.reservationFor.location["@type"]="Place"),delete e.bookingTime;T=/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}/.test(e.reservationFor.startDate)?/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2})/.exec(e.reservationFor.startDate):null;if(e.reservationFor.startDate=T?T[1].concat("T",T[2]):e.reservationFor.startDate,!1===/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}:?\d{2})?)?$/.test(e.reservationFor.startDate))(U=Scanner.fromMessage(t)).setLocale(r),e.reservationFor.startDate=e.reservationFor.startDate&&t.plain?U.getDetachedSpan(t.plain.replace(/\/\//," ")).firstDate():e.reservationFor.startDate;e.reservationFor.name=e.reservationFor.name?e.reservationFor.name.replace(/\|/g,","):null,e.reservedTicket&&(e.reservedTicket.ticketedSeat=e.reservedTicket.ticketedSeat?e.reservedTicket.ticketedSeat.replace(/\|/g,"/"):null),e.price=!0===/\d{1,}\.\d{3,}/.test(e.price)?/(\d{1,}\.\d{2})/.exec(e.price)[1]:e.price}if(/tablecheck\.com/i.test(t.from)&&(e.reservationFor.name=e.reservationFor.name.replace(/\\+"/g,"")),/reservations.rentalcars.com/i.test(t.from)&&(U=Scanner.fromMessage(t),/^\{.+\}$/.test(e.dropoffLocation.name)||/^\{.+\}$/.test(e.pickupLocation.name)))return CONTINUE;if(/customerservice\@ticketone\.it/.test(t.from)&&e.reservationFor.startDate&&/\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}/.test(e.reservationFor.startDate)){T=/(\d{4}\-\d{2}\-\d{2})\s(\d{2}\:\d{2}\:\d{2})/.exec(e.reservationFor.startDate);e.reservationFor.startDate=T[1].concat("T",T[2])}if(/noreply@despegar.com/i.test(t.from)||/VentasMX@despegar.com/i.test(t.from)){(U=Scanner.fromMessage(t)).setLocale("es_ES");u=U.getSpan().next(/Entrada/).nextDate(),g=U.getSpan().next(/Salida/).nextDate();e.checkinDate=unSpanDate_(u),e.checkoutDate=unSpanDate_(g)}if(/hotel@trans.priceline.com/i.test(t.from)){(U=Scanner.fromMessage(t)).setLocale("en_US");d=U.getSpan().next(/Check-in/i).nextDate().parentAnyTag("td").innerCapture(/(\d{2}:\d{2} [AP]M)/,1),l=U.getSpan().next(/Check-out/i).nextDate().parentAnyTag("td").innerCapture(/(\d{2}:\d{2} [AP]M)/,1);e.checkinDate=combineDateAndTime(e.checkinDate,d),e.checkoutDate=combineDateAndTime(e.checkoutDate,l),e.modifiedTime=null}if(/booking@singaporeair\.com\.sg/i.test(t.from)&&/^cancell?ation/i.test(t.subject)&&(e.reservationStatus="http://schema.org/Cancelled"),/documents@yourbooking\.qantas\.com\.au/i.test(t.from)&&((U=Scanner.fromMessage(t)).setLocale("en_US"),e.reservationFor&&(/\+/.test(e.reservationFor.departureTime)||/\+/.test(e.reservationFor.arrivalTime))&&(e.reservationFor.departureTime=U.getDetachedSpan(/(.+?)T/.exec(e.reservationFor.departureTime)[1]+" "+/T(.+?)[+-]/.exec(e.reservationFor.departureTime)[1]).innerDate(),e.reservationFor.arrivalTime=U.getDetachedSpan(/(.+?)T/.exec(e.reservationFor.arrivalTime)[1]+" "+/T(.+?)[+-]/.exec(e.reservationFor.arrivalTime)[1]).innerDate()),e.reservationFor&&e.reservationFor.flightNumber&&(e.reservationFor.flightNumber.length>4&&(e.reservationFor.iataCode=/([A-Z\d]{2})/.exec(e.reservationFor.flightNumber)[1]),e.reservationFor.flightNumber=/([\d]+)/.exec(e.reservationFor.flightNumber)[1])),/(?:notification|contact)@thefork\.com/i.test(t.from)&&((U=Scanner.fromMessage(t)).setLocale("en_US"),e.startTime&&(e.startTime=U.getSpan().firstDate())),/(?:contatto|notification)@thefork\.it/i.test(t.from)&&((U=Scanner.fromMessage(t)).setLocale("it_IT"),e.startTime&&(e.startTime=U.getSpan().firstDate()),e.reservationFor.telephone=U.getSpan().next("Ristorante").nextTag("td6").nextTag("td6").innerPhoneNumber()),/reservas@restaurantes\.com/i.test(t.from)){if(e.reservationFor.telephone=/\+\d{2}\+\d{2}/.test(e.reservationFor.telephone)?e.reservationFor.telephone.substring(3):e.reservationFor.telephone,""===e.startTime){(U=Scanner.fromMessage(t)).setLocale("es_ES");var C=U.getSpan().allDates();e.startTime=combineDateAndTime(C[0],C[1])}e.reservationFor["@type"]="http://schema.org/FoodEstablishment"}if(/reserveringen@email\.couverts\.nl/i.test(t.from)&&""===e.startTime.split(/T/)[0]){(U=Scanner.fromMessage(t)).setLocale("nl_NL");C=U.getSpan().allDates();e.startTime=combineDateAndTime(C[0],C[1])}if(/bordkarte@lufthansa.com/i.test(t.from)){(U=Scanner.fromMessage(t)).setLocale("de_DE");var A=U.getSpan().next(/Flugdetails/i).nextTag("td4").nextTag("td4").innerCapture(/(\d{1,2}:\d{1,2})/,1);e.reservationFor.departureTime=combineDateAndTime(e.reservationFor.departureTime,A)}if(/cheapoair@cheapoair\.com/i.test(t.from)&&e.reservationFor&&"0000000000"===e.reservationFor.telephone&&delete e.reservationFor.telephone,/reservations@marriott-res\.com/i.test(t.from)&&e.reservationNumber&&/\d{8,12}/.test(e.reservationNumber)&&(e.reservationNumber=/\d{8,12}/.exec(e.reservationNumber)[0]),/reservations@ac-hotels-res\.com/i.test(t.from)&&e.reservationNumber&&/\d{8,12}/.test(e.reservationNumber)&&(e.reservationNumber=/\d{8,12}/.exec(e.reservationNumber)[0]),/reservations@ritzcarlton-res\.com/i.test(t.from)&&e.reservationNumber&&/\d{8,12}/.test(e.reservationNumber)&&(e.reservationNumber=/\d{8,12}/.exec(e.reservationNumber)[0]),/reservations@fairfieldinn-res\.com/i.test(t.from)&&e.reservationNumber&&/\d{8,12}/.test(e.reservationNumber)&&(e.reservationNumber=/\d{8,12}/.exec(e.reservationNumber)[0]),/reservations@residenceinn-res\.com/i.test(t.from)&&e.reservationNumber&&/\d{8,12}/.test(e.reservationNumber)&&(e.reservationNumber=/\d{8,12}/.exec(e.reservationNumber)[0]),/cityboxoffice\.com/i.test(t.from)){(U=Scanner.fromMessage(t)).setLocale(r);var N=loadHelper("vocab.js")(r);(H=loadHelper("schemaorgFixMalformedVirtual.js")(t,U,N,e))&&(e.reservationFor.location={"@type":"http://schema.org/VirtualLocation",url:loadHelper("streamLink.js")(U,N,t)})}if(/confirmation@etix\.com/i.test(t.from)&&e.reservationFor.location.address){e.reservationFor.location.address=undefined,(U=Scanner.fromMessage(t)).setLocale(r);N=loadHelper("vocab.js")(r);var y=loadHelper("undername.js")(t.to,N,U,t.subject),j=loadHelper("name.js")(t.subject,N,U,t).trim(),L=loadHelper("place.js")(N,U,j,t.subject,null,"tickets"),E=loadHelper("address.js")(N,U,t,j,y,L);loadHelper("isVirtual.js")(j,L,E,N,U)&&(e.reservationFor.location={"@type":"http://schema.org/VirtualLocation",url:loadHelper("streamLink.js")(U,N,t)})}if(/ticketmaster\./i.test(t.from)){(U=Scanner.fromMessage(t)).setLocale(r);N=loadHelper("vocab.js")(r);var H=loadHelper("schemaorgFixMalformedVirtual.js")(t,U,N,e),M="de_DE"===r?/Deine Bestellbest\xe4tigung/i:"es_ES"===r?/Confirmaci\xf3n de compra/i:"nl_NL"===r?/Jouw orderbevestiging/i:null;M&&M.test(t.plain)&&/SOLD|PURCHASED/i.test(e.reservationStatus)&&(e.reservationStatus="http://schema.org/ReservationConfirmed"),H&&(e.reservationFor.location={"@type":"http://schema.org/VirtualLocation",url:loadHelper("streamLink.js")(U,N,t)})}/nextable\.net/.test(t.from)&&(e.modifiedTime=!1===/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}:?\d{2})?)?$/.test(e.modifiedTime)?null:e.modifiedTime,(U=Scanner.fromMessage(t)).setLocale(r),(a=U.getDetachedSpan(t.plain).allDates())[0]=a?U.getDateDD(a[0]).iso8601:a[0],a[1]=a&&2===a.length?/\d{4}\-\d{2}\-\d{2}(T\d{2}\:\d{2}\:\d{2})/.exec(U.getDateDD(a[1]).iso8601)[1]:a[1],e.startTime=a&&a[1]?a[0].concat(a[1]):e.startTime);if(/cheapoair@cheapoair\.com/i.test(t.from)&&/Flight(\sBooking)?\sDetails/.test(t.plain)&&(_=(U=Scanner.fromMessage(t)).getSpan().nextText("Airline Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9]{4,}/),I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0],e.reservationFor.departureAirport&&(e.reservationNumber=null!==_?_[0]:I)),/cheapoair@cheapoair\.com/i.test(t.from)&&/Car(\sBooking)?\sDetails/.test(t.plain)&&(_=(U=Scanner.fromMessage(t)).getSpan().nextText("Car Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9]{4,}/),I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0],e.pickupLocation&&(e.reservationNumber=null!==_?_[0]:I)),/cheapoair@cheapoair\.com/i.test(t.from)&&/Hotel(\sBooking)?\sDetails/.test(t.plain)&&(null===(_=(U=Scanner.fromMessage(t)).getSpan().nextText("Check-In Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9-]{6,}/))&&(_=U.getSpan().nextText("Hotel Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9-]{6,}/)),I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0],e.checkinDate&&(e.reservationNumber=null!==_?_[0]:I)),/cheapoair@cheapoair\.com/i.test(t.from)&&/Flight(\sBooking)?\sDetails/.test(t.plain)){var _=(U=Scanner.fromMessage(t)).getSpan().nextText("Airline Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9]{4,}/),I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0];e.reservationFor.departureAirport&&(e.reservationNumber=null!==_?_[0]:I)}if(/cheapoair@cheapoair\.com/i.test(t.from)&&/Car(\sBooking)?\sDetails/.test(t.plain)){_=(U=Scanner.fromMessage(t)).getSpan().nextText("Car Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9]{4,}/),I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0];e.pickupLocation&&(e.reservationNumber=null!==_?_[0]:I)}if(/cheapoair@cheapoair\.com/i.test(t.from)&&/Hotel(\sBooking)?\sDetails/.test(t.plain)){null===(_=(U=Scanner.fromMessage(t)).getSpan().nextText("Check-In Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9-]{6,}/))&&(_=U.getSpan().nextText("Hotel Confirmation").parentAnyTag("td").innerCapture(/[A-Z0-9-]{6,}/));I=null===(O=U.getSpan().nextText("CheapOair Booking:").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Booking #:").nextAnyTag("td").tagContents():O[0];e.checkinDate&&(e.reservationNumber=null!==_?_[0]:I)}if(/cheapoair@cheapoair\.com/i.test(t.from)&&/Detalles de reserva del vuelo/.test(t.plain)){var O;_=(U=Scanner.fromMessage(t)).getSpan().nextText("Confirmaci\xf3n de la aerol\xednea:").parentAnyTag("td").innerCapture(/[A-Z0-9]{4,}/),I=null===(O=U.getSpan().nextText("N\xfamero de reserva").parentAnyTag("td").innerCapture(/\d{6,}/))?U.getSpan().nextText("Reservaci\xf3n #:").nextAnyTag("td").tagContents():O[0];e.reservationFor.departureAirport&&(e.reservationNumber=null!==_?_[0]:I)}if(/cheapoair@cheapoair\.com/i.test(t.from)&&e.modifiedTime&&(e.modifiedTime=""),/roomservice@hotel\.com\.au/i.test(t.from)&&!e.checkinDate)return CONTINUE;if(/customer\.service@booking\.com/i.test(t.from)&&!e.checkinDate)return CONTINUE;if(/noreply\.hotels@opodo.(?:com|fr|it|de|nl|co\.uk)/i.test(t.from)&&!e.checkinDate)return CONTINUE;if(/orders@eventbrite\.com/i.test(t.from)&&(e.reservationFor&&e.reservationFor.name&&(e.reservationFor.name=e.reservationFor.name.replace(/&#39;/,"'")),e.reservationFor.location&&(e.reservationFor.location.name=e.reservationFor&&e.reservationFor.location&&e.reservationFor.location.name&&/\s\|\s/.test(e.reservationFor.location.name)?e.reservationFor.location.name.replace(/\s\|\s/g," / "):e.reservationFor.location.name,e.reservationFor.location.address.streetAddress=e.reservationFor&&e.reservationFor.location&&e.reservationFor.location.address&&e.reservationFor.location.address.streetAddress&&/\s\|\s/.test(e.reservationFor.location.address.streetAddress)?e.reservationFor.location.address.streetAddress.replace(/\s\|\s/g," / "):e.reservationFor.location.address.streetAddress)),/order\.eventbrite\.com/i.test(t.from)){var U=Scanner.fromMessage(t);/\d{4}-\d{1,2}-\d{1,2}\s\d{2}:\d{2}:\d{2}/.test(e.reservationFor.startDate)&&(splitDate=e.reservationFor.startDate.split(" "),e.reservationFor.startDate=splitDate[0]+"T"+splitDate[1]),/\d{4}-\d{1,2}-\d{1,2}\s\d{2}:\d{2}:\d{2}/.test(e.reservationFor.endDate)&&(splitDate=e.reservationFor.endDate.split(" "),e.reservationFor.endDate=splitDate[0]+"T"+splitDate[1]),U.setLocale(r);N=loadHelper("vocab.js")(r);(H=loadHelper("schemaorgFixMalformedVirtual.js")(t,U,N,e))&&(e.reservationFor.location={"@type":"http://schema.org/VirtualLocation",url:loadHelper("streamLink.js")(U,N,t)})}if(/goldstar.com/i.test(t.from)){if(N=loadHelper("vocab.js")(r),(U=Scanner.fromMessage(t)).setLocale(r),loadHelper("bail.js")(N,U))return CONTINUE;if("http://schema.org/DanceEvent"===e.reservationFor["@type"]&&(e.reservationFor["@type"]="http://schema.org/Event"),e.reservationFor.name&&e.reservationFor.startDate){var P=new Date(e.reservationFor.startDate),R=(C=U.getSpan().allAbsoluteDates()).some(function(e){return P.isSameDay(new Date(e.toString()))});if(C.length>0&&!R)return CONTINUE}}if(/donotreply@showclix.com/.test(t.from)){e.reservationFor&&e.reservationFor.offers&&delete e.reservationFor.offers,(U=Scanner.fromMessage(t)).setLocale(r);N=loadHelper("vocab.js")(r),j=loadHelper("name.js")(t.subject,N,U,t).trim(),L=loadHelper("place.js")(N,U,j,t.subject,null,"tickets"),E=loadHelper("address.js")(N,U,t,j,null,L);loadHelper("isVirtual.js")(j,L,E,N,U)&&(e.reservationFor.location={"@type":"http://schema.org/VirtualLocation",url:loadHelper("streamLink.js")(U,N,t)})}if(/comunicacaovoegol\@voegol\.com\.br/i.test(t.from)&&e&&e.modifiedTime&&delete e.modifiedTime,/fnactickets\.com/i.test(t.from)){delete e.bookingDate;var $=e&&e.reservationFor&&e.reservationFor.startDate&&/(\d{4}\-)(\d{1,2})(\-\d{2}T\d{2}\:\d{2}\:\d{2}\+)\d(\d{2}\:\d{2})/.test(e.reservationFor.startDate)?/(\d{4}\-)(\d{1,2})(\-\d{2})(T\d{2}\:\d{2}\:\d{2}\+)\d(\d{2}\:\d{2})/.exec(e.reservationFor.startDate):null;$&&($[2]=/^\d{1}$/.test($[2])?"0".concat($[2]):$[2],$[3]=/^-\d{1}$/.test($[3])?"0".concat($[3]):$[3],e.reservationFor.startDate=$[1].concat($[2],$[3],$[4],$[5]))}if(/confirmation\@fnacspectacles\.com|serviceclients@fnacspectacles.com/i.test(t.from)){if(e.reservationFor&&e.reservationFor.performer&&e.reservationFor.performer.name&&Array.isArray(e.reservationFor.performer.name)&&(e.reservationFor.performer.name=e.reservationFor.performer.name.join(", ")),e.bookingDate)T=/\d{4}\-\d{1}\-\d{1,2}T\d{2}\:\d{2}\:\d{2}\+\d{2,3}\:\d{2}/.test(e.bookingDate)?delete e.bookingDate:null;if(e.reservationFor.startDate)(T=/\d{4}\-\d{1}\-\d{1,2}T\d{2}\:\d{2}\:\d{2}\+\d{2,3}\:\d{2}/.test(e.reservationFor.startDate)?/(\d{4})\-(\d{1})\-(\d{1,2})(T\d{2}\:\d{2}\:\d{2})\+(\d{2,3})(\:\d{2})/.exec(e.reservationFor.startDate):null)&&(T[2]=1===T[2].length?"0".concat(T[2]):T[2],T[3]=1===T[3].length?"0".concat(T[3]):T[3],T[5]=2!==T[5].length&&"0"===T[5][0]?T[5][1].concat(T[5][2]):T[5],e.reservationFor.startDate=T[2]&&T[3]&&T[5]?T[1].concat("-",T[2],"-",T[3],T[4],"+",T[5],T[6]):e.reservationFor.startDate)}if(/(?:mail\.hotele?s|email\.carlsonhotels|goibibo|(?:ac-hotels|autographcollectionhotels|courtyard|editionhotels|fairfieldinn|(?:jw)?marriott|renaissancehotels|residenceinn|ritzcarlton|springhillsuites|towneplace|vacationclub)-res)\.com/i.test(t.from)){if((N=loadHelper("vocab.js")(r))&&(null===e.checkinDate||""===e.checkinDate||null===e.checkoutDate||""===e.checkoutDate||/00:00:00/.test(e.checkinDate)||/00:00:00/.test(e.checkoutDate))){var B=loadHelper("schemaorgHotelTimeHelper.js")(t,r);e.checkinDate=B[0],e.checkoutDate=B[1]}e.reservationId&&(e.reservationId=e.reservationId.replace(/.+:\s*(\d+[a-z]{2}\d+|\d+-\d+\/[a-zA-Z\d]+|[\d.]{12,}|[A-Z\d:]{4,}|[A-Z\d-]{6,}|[A-Z\d-\s]{15,}|\d{2,})/,"$1"))}if(/res@laterooms\.com/i.test(t.from)){var Z=function(e){var t=/(\d{4}\-\d{2}\-\d{2}T(?:\d{2}:?){3})\.\d+\w?(\+\d+:\d+)?/;if(t.test(e)){var r=e.match(t);return e=e.replace(t,2===r.length?"$1":"$1$2")}};e.checkinDate=Z(e.checkinDate),e.checkoutDate=Z(e.checkoutDate),e.modifiedTime=null,(U=Scanner.fromMessage(t)).setLocale("en_US");var w=/Check in.{50,90}\[\/td3\]/;if((X=U.getSpan()).next(w).exists()){var z=X.next(w).nextDate(),V=(u=X.next(w).nextAnyTag("td").nextAnyTag("td").innerDate(),combineDateAndTime(z,u));e.checkinDate=V}var W=/Check out.{50,90}\[\/td3\]/;if(X.next(W).exists()){var q=X.next(W).nextDate(),J=(g=X.next(W).nextAnyTag("td").nextAnyTag("td").innerDate(),combineDateAndTime(q,g));e.checkoutDate=J}}if(/confirmation@trx\.fandangopurchase\.com/.test(t.from)&&/Purchase Confirmation/.test(t.subject)&&!e.reservationFor)return CONTINUE;if(/atrapalo\-no\-reply@atrapalo\.com/.test(t.from)&&(e.modifiedTime=!1===/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}:?\d{2})?)?$/.test(e.modifiedTime)?null:e.modifiedTime),/email\.zomatobook\.com/.test(t.from)){e.modifiedTime=!1===/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}:?\d{2})?)?$/.test(e.modifiedTime)?null:e.modifiedTime,e.bookingTime=!1===/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d{1,6})?(?:Z|[-\+]\d{2}:?\d{2})?)?$/.test(e.bookingTime)?null:e.bookingTime,(U=Scanner.fromMessage(t)).setLocale(r);T=e.startTime&&t.plain?U.getDetachedSpan(t.plain).firstDate():null;e.startTime=T?U.getDateDD(T).iso8601:e.startTime}if(/lafourchette\.com/.test(t.from)){(U=Scanner.fromMessage(t)).setLocale(r);T=e.startTime&&t.plain?U.getDetachedSpan(t.plain).firstDate():null;e.startTime=T?U.getDateDD(T).iso8601:e.startTime}/noreply\@exploretock\.com/.test(t.from)&&((U=Scanner.fromMessage(t)).setLocale(r),e.startTime=e.modifiedTime?U.getDetachedSpan(e.modifiedTime).firstDate():e.startTime,delete e.modifiedTime,"N/A"===e.reservationFor.telephone&&delete e.reservationFor.telephone);if(/movies\.fandango\.com/.test(t.from)&&/A \W\d{1,4}\W\d{2} credit will be added to your Fandango account\./.test(t.plain)&&(e.reservationStatus="http://schema.org/ReservationCancelled"),/confirmation@trx\.fandango\.com/.test(t.from)&&/Purchase Confirmation/.test(t.subject)&&e.reservationFor.location&&Array.isArray(e.reservationFor.location)&&(e.reservationFor.location=e.reservationFor.location[0]),/confirmation@trx\.fandangopurchase\.com/.test(t.from)&&/Refund Confirmation/.test(t.subject)&&(e.reservationStatus="http://schema.org/ReservationCancelled"),/confirmation@movies\.fandango\.com/.test(t.from)||/confirmation@trx\.fandangopurchase\.com/.test(t.from)&&/Refund Confirmation/.test(t.subject)){if(!e.reservationFor)return CONTINUE;(U=Scanner.fromMessage(t)).setLocale("en_US");var K=U.getSpan();e.reservationFor.name instanceof Array&&(e.reservationFor.name=null);var G=K.allDates()[0];A=K.allDates()[1];/\w+,\s\w+\s\d+,\s\d+/.test(G.toString())||(G=K.allDates()[1],A=K.allDates()[2]),e.reservationFor.startDate=combineDateAndTime(G,A).toString()}if(/@bookmyshow\.email/.test(t.from)&&/Your Tickets/.test(t.subject)&&!e.reservationFor)return CONTINUE;if(/mail.travel.rakuten.co.jp/.test(t.from)&&/.\u697d\u5929\u30c8\u30e9\u30d9\u30eb.\u4e88\u7d04\u5b8c\u4e86\u30e1\u30fc\u30eb \(\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u65e5.\d{2}\/\d{2}\)/.test(t.subject)&&e.checkinDate&&e.checkinDate.indexOf("T")>-1&&e.checkinDate.indexOf("+")>-1){var Y=(A=e.checkinDate.split("T")[1]).split("+")[1];/00:00:00/.test(A)&&((U=Scanner.fromMessage(t)).setLocale(r),(A=loadHelper("starttime.js")(loadHelper("vocab.js")(r),U,t)).exists()&&(A=U.getDateDD(A).iso8601+"+"+Y,e.checkinDate=A))}if((/@sixt\.com/.test(t.from)||/@sixt.it/.test(t.from))&&(null===e.pickupTime||""===e.pickupTime))return CONTINUE;if(/@e\.avis\.com/.test(t.from)&&/ReservationConfirmed/.test(e.reservationStatus)&&/your reservation has been canceled/.test(t.subject)&&(e.reservationStatus="http://schema.org/ReservationCancelled"),/@hertz\.com/.test(t.from)&&(e.priceCurrency&&/^\$/.test(e.priceCurrency)&&delete e.priceCurrency,e.reservationFor&&e.reservationFor.model&&/^\$/.test(e.reservationFor.model)&&delete e.reservationFor.model),/(?:nationalcar|goalamo).com/i.test(t.from)){N=loadHelper("vocab.js")(r),(U=Scanner.fromMessage(t)).setLocale(r);var X=U.getSpan(),Q=U.getSpan().allDates();if(0===Q.length)return STOP;var ee=loadHelper("getCandidates.js"),te=ee([N.pickUpDateTimeCapture,N.pickUpBlockPrefix,N.pickUpDateTimePrefix,N.pickUpDatePrefix,N.pickUpTimePrefix],X,function(e,t){var r=e.innerCapture(t);if(r&&2===r.length)r=r[1];else{if(!r||3!==r.length)return Q.filter(function(t){return t.getStart()>=e.getEnd()});r=U.getDetachedSpan(r.$date+" "+r.$time)}return[r]},function(e){var t=U.getDateDD(e);return/[\d\uff10-\uff19]{1,2}/i.test(e.toString())&&t&&t.is(["Date","DateTime","DateDuration"])}),re=ee([N.dropOffDateTimeCapture,N.dropOffBlockPrefix,N.dropOffDateTimePrefix,N.dropOffDatePrefix,N.dropOffTimePrefix],X,function(e,t){var r=e.innerCapture(t);if(r&&2===r.length)r=r[1];else{if(!r||3!==r.length)return Q.filter(function(t){if(t.getStart()<e.getEnd())return!1;var r=U.getDateDD(t);return dateTimeSpanToEpoch(r&&r.is(["DateDuration"])?r.endIso8601:r.iso8601)>dateTimeSpanToEpoch(te)});r=U.getDetachedSpan(r.$date+" "+r.$time)}return[r]},function(e){var t=U.getDateDD(e);return/[\d\uff10-\uff19]{1,2}/i.test(e.toString().trim())&&t&&t.is(["Date","DateTime"])},function(e){var t=U.getDateDD(e);return t&&t.is(["DateDuration"])?U.getDetachedSpan(t.endIso8601):e});e.pickupTime=te,e.dropoffTime=re}if(/eet\.nu/i.test(t.from)&&(/accepted|bevestigd/.test(t.subject)&&(e.reservationStatus="http://schema.org/ReservationPending"===e.reservationStatus?"http://schema.org/ReservationConfirmed":e.reservationStatus),e.reservationStatus="http://schema.org/ReservationPending"===e.reservationStatus?"http://schema.org/ReservationCancelled":e.reservationStatus),/noreply@DineTime\.com/i.test(t.from)&&/Reservation Cancell?ation/.test(t.subject)&&((U=Scanner.fromMessage(t)).setLocale(r),e.startTime=U.getSpan().next(/You have successfully cancell?ed/).nextDate()),/chope\.co/.test(t.from)&&e.reservationFor.address.streetAddress&&(e.reservationFor.address.streetAddress=e.reservationFor.address.streetAddress.replace(/,?<br>/g,", ")),/oyorooms\.com/.test(t.from)&&(/content=\"{&quot;id&quot;=&gt;\d{1},/.test(t.html)&&(e.reservationFor.address.addressLocality=/&quot;name&quot;=&gt;&quot;(.+)&quot;, &quot;created_at/.exec(t.html)[1]),e.underName.name=/Dear (.+),/.exec(t.plain)[1],e.underName.email=null),/mail\.hotele?s\.com/.test(t.from)&&/main\-guest\-full\-name room\-0/.test(t.html)&&(e.underName.name=/<span class="main\-guest\-full\-name room\-0">(.+)<\/span>(?:,|\uff0c|\s\u69d8\u3001)\s*<span class="num\-of\-adults/.exec(t.html)[1]),/mrandmrssmith\.com/.test(t.from)){B=loadHelper("schemaorgHotelTimeHelper.js")(t,r);e.checkinDate=B[0],e.checkoutDate=B[1]}if(/melia\.com/i.test(t.from)){U=Scanner.fromMessage(t),N=loadHelper("vocab.js")(r);B=loadHelper("schemaorgHotelTimeHelper.js")(t,r,U,N);e.checkinDate=B[0],e.checkoutDate=B[1],e.reservationFor.name=loadHelper("hotelname.js")(N,U,t)}if(/millenniumhotels\.com/i.test(t.from)){B=loadHelper("schemaorgHotelTimeHelper.js")(t,r);e.checkinDate=B[0],e.checkoutDate=B[1]}if(/francebillet\.com/i.test(t.from)&&(delete e.bookingDate,/(\d{4}-)(\d{1})(-\d{2}T\d{2}\:\d{2}\:\d{2}\+)(\d{3})(\:\d{2})/.test(e.reservationFor.startDate))){var ae=/(\d{4}-)(\d{1})(-\d{2}T\d{2}\:\d{2}\:\d{2}\+)(\d{2})(\d{1})(\:\d{2})/.exec(e.reservationFor.startDate);e.reservationFor.startDate=ae[1].concat("0",ae[2],ae[3],ae[4],ae[6])}
return/booking.com/.test(t.from)&&"FlightReservation"===e["@type"]&&((e=/({\".+?)(?:\\n)+?(\".+})/.test(JSON.stringify(e))?JSON.parse(JSON.stringify(e).replace(/\\n/g,"")):e).reservationId=!e.reservationId&&regExpFormatted(/Customer\sreference\1\]\s+?([\d-]+?)\s\1PIN\scode/i,o.monochrome.tablePassLight).test(t.plain)?regExpFormatted(/Customer\sreference\1\]\s+?([\d-]+?)\s\1PIN\scode/i,o.monochrome.tablePassLight).exec(t.plain)[1]:e.reservationId),/airbnb.com/.test(t.from)&&(e.checkinDate&&(e.checkinDate=/^\d{4}-\d{2}-\d{2}T\d{1,2}\:\d{2}$/.test(e.checkinDate)?e.checkinDate.concat(":00"):e.checkinDate),e.checkoutDate&&(e.checkoutDate=/^\d{4}-\d{2}-\d{2}T\d{1,2}\:\d{2}$/.test(e.checkoutDate)?e.checkoutDate.concat(":00"):e.checkoutDate),"en_US"===r?e.reservationFor.name=e.reservationFor&&e.reservationFor.name&&/^Reservation confirmed for\s(.+?)$/.test(t.subject)?/^Reservation confirmed for\s(.+?)$/.exec(t.subject)[1]:e.reservationFor.name:"fr_FR"===r&&(e.reservationFor.name=e.reservationFor&&e.reservationFor.name&&/^R\xe9servation confirm\xe9e pour\s(.+?)$/.test(t.subject)?/^R\xe9servation confirm\xe9e pour\s(.+?)$/.exec(t.subject)[1]:e.reservationFor.name)),/sewardhelicopters.com/.test(t.from)&&e.modifiedTime&&delete e.modifiedTime,/iberia\.com/i.test(t.from)?CONTINUE:e}}).call();