(function(){return function(e,t){var n=Scanner.fromMessage(e);n.setLocale("en_US");var r=n.getSpan(),a=[],o=[],i=[],c=e.plain.split(/Check In/i).length-1;r=r.next(/Trip Overview/);for(var s=0;s<c;s++)r=r.next(/(^Hotel[\s\S]*?)(?:^Flight [A-Z]|^Hotel$|^Car Rental$|^Plan)/gm),i.push(r.toString());return i.forEach(function(e){var r,a,i,c,s,h,l,m,u,d,p,v,g,k,f,T,D=n.getDetachedSpan(e),I=e.slice(),S=/Hotel.*?\s+(?:.+?\n\s+)?(.+?)\n\s+(.+?)\s<_link_>\s+([\d\s-]+)\nCheck\sIn/,C=S.test(I);if(!1!==C){var x=C?S.exec(e):null;g=C&&x[1]?x[1].trim():null,f=C&&x[2]?x[2].trim():null,k=C&&x[3]?x[3].trim():null;var y=/Confirmation #.*\n.*\n(.*)\n/.exec(I);c=y&&2===y.length?y[1]:null,p=(m=D.next(/Check in/i).nextDate()).nextDate(),(r=/Rate.*\n.*\n([\d,.]+)\s*([A-Z]{2,3})/.exec(I))&&3===r.length&&(a=r[1],i=r[2]),o.push({totalPrice:a,priceCurrency:i,reservationId:c,reservationStatus:s,checkInTime:h,checkInDate:l,checkInDateTime:m,checkOutTime:u,checkOutDate:d,checkOutDateTime:p,hotelUrl:v,hotelName:g,hotelPhone:k,hotelAddress:f,modifyReservationUrl:T,underPersonName:t.underName})}}),o.forEach(function(e){ASSERT(e.checkInDateTime,e.checkOutDateTime,e.hotelName,e.hotelAddress),a.push({"@context":"http://schema.org","@type":"http://schema.org/LodgingReservation",underName:{"@type":"http://schema.org/Person",name:e.underPersonName},totalPrice:e.totalPrice,priceCurrency:e.priceCurrency,checkinTime:e.checkInDateTime,checkoutTime:e.checkOutDateTime,modifyReservationUrl:e.modifyReservationUrl,reservationStatus:"http://schema.org/Reservation"+(e.reservationStatus||"Confirmed"),reservationId:e.reservationId,reservationFor:{"@type":"http://schema.org/LodgingBusiness",name:e.hotelName,url:e.hotelUrl,telephone:e.hotelPhone,address:e.hotelAddress}})}),a.length>=1?a:CONTINUE}}).call();